getAntennaDetails:
  cypher: "MATCH (n:Antenna) RETURN n.id as id,n.npiId, n.resourceStatus, n.usageState,n.administrativeState,n.name, n.manufactureDate,n.legacyAddressValue "
getBatteryDetails:
  cypher: "MATCH (n:Battery) RETURN n.id,n.npiId, n.resourceStatus, n.usageState,n.administrativeState,n.name, n.manufactureDate,n.legacyAddressValue "
getCardDetails:
  cypher: "MATCH (n:Card) RETURN n.id,n.npiId, n.resourceStatus, n.usageState,n.administrativeState,n.name, n.manufactureDate,n.legacyAddressValue "
getDeviceDetails:
  cypher: "MATCH (n:Device) RETURN n.id,n.npiId, n.resourceStatus, n.usageState,n.administrativeState,n.name, n.manufactureDate,n.legacyAddressValue "
getAntennaReport:
  cypher: "MATCH (obj:Antenna)-[:ANTENNA_AT_NODECODE]-(nodeCode), (obj)-[:_ASSOCIATED_ANTENNA_TYPE]-(objType) WHERE {{WHERE_CLAUSE}} AND ($id IS NULL OR obj.id = $id) AND ($npiId IS NULL OR obj.npiId = $npiId) OPTIONAL MATCH (obj)-[r]->(parent)-[rp]->(objParentType) WHERE type(r) IN ['ANTENNA_HAS_ANTENNA','ITEM_HAS_ANTENNA','TRAY_HAS_ANTENNA','RACK_HAS_ANTENNA','DEVICE_HAS_ANTENNA'] AND type(rp) STARTS WITH '_ASSOCIATED' CALL apoc.path.subgraphAll(obj, {relationshipFilter: '<ANTENNA_HAS_ANTENNA|<ITEM_HAS_ANTENNA|<TRAY_HAS_ANTENNA|<RACK_HAS_ANTENNA|<DEVICE_HAS_ANTENNA|<RACK_HAS_DEVICE|<RACK_HAS_ITEM|<RACK_HAS_TRAY|<SUBSTRUCTURE_AT_SUBSTRUCTURE|>RESOURCE_AT_SUBSTRUCTURE', minLevel: 1, maxLevel: 4}) YIELD nodes, relationships WITH obj, nodeCode, objType, objParentType, collect(obj + nodes + relationships) as path, reverse(obj + nodes) AS nodeList UNWIND nodeList AS n WITH obj, nodeCode, objType, objParentType, path, COLLECT(DISTINCT case labels(n)[0] when 'Place' then null when 'SubStructure' then n.name when 'Antenna' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Battery' then apoc.text.join ([(n)-[r:_ASSOCIATED_BATTERY_TYPE]-(bt:Battery_Type) | bt.typeClass + ' ' + n.physicalAddressValue],'') when 'CableSet' then apoc.text.join ([(n)-[r:_ASSOCIATED_CABLESET_TYPE]-(cst:CableSet_Type) | cst.typeClass + ' ' + n.physicalAddressValue],'') when 'Card' then apoc.text.join ([(n)-[r:_ASSOCIATED_CARD_TYPE]-(ct:Card_Type) | ct.typeClass + ' ' + n.physicalAddressValue],'') when 'CircuitProtection' then apoc.text.join ([(n)-[r:_ASSOCIATED_CIRCUITPROTECTION_TYPE]-(cpt:CircuitProtection_Type) | cpt.typeClass + ' ' + n.physicalAddressValue],'') when 'Device' then apoc.text.join ([(n)-[r:_ASSOCIATED_DEVICE_TYPE]-(dt:Device_Type) | dt.typeClass + ' ' + n.physicalAddressValue],'') when 'DistributionFrame' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Drawer' then apoc.text.join ([(n)-[r:_ASSOCIATED_DRAWER_TYPE]-(drt:Drawer_Type) | drt.typeClass + ' ' + n.physicalAddressValue],'') when 'Filter' then apoc.text.join ([(n)-[r:_ASSOCIATED_FILTER_TYPE]-(ft:Filter_Type) | ft.typeClass + ' ' + n.physicalAddressValue],'') when 'FuseHolder' then apoc.text.join ([(n)-[r:_ASSOCIATED_FUSEHOLDER_TYPE]-(fht:FuseHolder_Type) | fht.typeClass + ' ' + n.physicalAddressValue],'') when 'Item' then apoc.text.join ([(n)-[r:_ASSOCIATED_ITEM_TYPE]-(it:Item_Type) | it.typeClass + ' ' + n.physicalAddressValue],'') when 'Level' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Rack' then case apoc.text.join ([(n)-[r:_ASSOCIATED_RACK_TYPE]-(rt:Rack_Type) | rt.typeClass],'') when 'Other' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Rack Housing' then labels(n)[0] + ' ' + n.physicalAddressValue else apoc.text.join ([(n)-[r:_ASSOCIATED_RACK_TYPE]-(rt:Rack_Type) | rt.typeClass + ' ' + n.physicalAddressValue],'') end when 'Side' then labels(n)[0] + ' ' + n.physicalAddressValue when 'TerminalBlock' then apoc.text.join ([(n)-[r:_ASSOCIATED_TERMINALBLOCK_TYPE]-(tbt:TerminalBlock_Type) | tbt.typeClass + ' ' + n.physicalAddressValue],'') when 'Tray' then apoc.text.join ([(n)-[r:_ASSOCIATED_TRAY_TYPE]-(tt:Tray_Type) | tt.typeClass + ' ' + n.physicalAddressValue],'') when 'Vertical' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Zone' then labels(n)[0] + ' ' + n.physicalAddressValue when 'Shelf' then null when 'Slot' then null else labels(n)[0] + ' ' + n.physicalAddressValue end) AS nodeDescriptions RETURN obj.id as id, 'Antenna' as object_category, obj.name as element_id, nodeCode.name as site_code, apoc.text.join(nodeDescriptions, ', ') AS location_in_site, objType.typeName as manufacturer_type, obj.hardwareRevision as hw_revision, obj.resourceStatus as resource_status, objType.typeDescription as manufacturer_description, '' as application_system, '' as eq_group_class, '' as eq_group_id, obj.barcode as barcode, split(objType.typeName, ' ')[0] as manufacturer_name, obj.npiId as npi_id, obj.serialNumber as serial_number, objParentType.typeName as parent_type, obj.manufactureDate as date_manufactured"
  fieldMapping:
    manufacturer_type: "objType.typeName"
    manufacturer_name: "objType.typeName"
    structure_state: "nodeCode.name"
    resource_status: "obj.resourceStatus"
    object_category: "'Antenna'"
    element_id: "obj.name"
    site_code: "nodeCode.name"
    npi_id: "obj.npiId"
    serial_number: "obj.serialNumber"
    date_manufactured: "obj.manufactureDate"
